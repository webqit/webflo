import{_ as t,c as s,o as a,a2 as l}from"./chunks/framework.9Uv4PgnO.js";const h=JSON.parse('{"title":"Handler API","description":"","frontmatter":{},"headers":[],"relativePath":"api/webflo-routing/handler.md","filePath":"api/webflo-routing/handler.md"}'),n={name:"api/webflo-routing/handler.md"};function o(r,e,p,c,i,d){return a(),s("div",null,[...e[0]||(e[0]=[l(`<h1 id="handler-api" tabindex="-1">Handler API <a class="header-anchor" href="#handler-api" aria-label="Permalink to &quot;Handler API&quot;">​</a></h1><p>Handlers are the entry point for all requests in Webflo. This page documents the formal contract for handler functions.</p><h2 id="signature" tabindex="-1">Signature <a class="header-anchor" href="#signature" aria-label="Permalink to &quot;Signature&quot;">​</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#89DDFF;font-style:italic;"> default</span><span style="color:#C792EA;"> async</span><span style="color:#C792EA;"> function</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> next</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> fetch</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span><span style="color:#676E95;font-style:italic;"> /* ... */</span><span style="color:#89DDFF;"> }</span></span></code></pre></div><h2 id="naming" tabindex="-1">Naming <a class="header-anchor" href="#naming" aria-label="Permalink to &quot;Naming&quot;">​</a></h2><p>A route may provide named exports to map specific HTTP requests to specific handlers:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#C792EA;"> async</span><span style="color:#C792EA;"> function</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> next</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> fetch</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span><span style="color:#676E95;font-style:italic;"> /* ... */</span><span style="color:#89DDFF;"> }</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#C792EA;"> async</span><span style="color:#C792EA;"> function</span><span style="color:#82AAFF;"> POST</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> next</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;font-style:italic;"> fetch</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span><span style="color:#676E95;font-style:italic;"> /* ... */</span><span style="color:#89DDFF;"> }</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// PUT, PATCH, DELETE, OPTIONS, HEAD are also supported</span></span></code></pre></div><table tabindex="0"><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>GET</code></td><td style="text-align:left;">Handle HTTP GET requests</td></tr><tr><td style="text-align:left;"><code>POST</code></td><td style="text-align:left;">Handle HTTP POST requests</td></tr><tr><td style="text-align:left;"><code>PUT</code></td><td style="text-align:left;">Handle HTTP PUT requests</td></tr><tr><td style="text-align:left;"><code>PATCH</code></td><td style="text-align:left;">Handle HTTP PATCH requests</td></tr><tr><td style="text-align:left;"><code>DELETE</code></td><td style="text-align:left;">Handle HTTP DELETE requests</td></tr><tr><td style="text-align:left;"><code>OPTIONS</code></td><td style="text-align:left;">Handle HTTP OPTIONS requests</td></tr><tr><td style="text-align:left;"><code>HEAD</code></td><td style="text-align:left;">Handle HTTP HEAD requests</td></tr></tbody></table><p>If a named export is not provided for an incoming method, Webflo falls back to the <code>default</code> export, if present.</p><h2 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;Parameters&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter</th><th style="text-align:left;">Type</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>event</code></td><td style="text-align:left;"><a href="/api/webflo-routing/HttpEvent"><code>HttpEvent</code></a></td><td style="text-align:left;">Current HTTP event.</td></tr><tr><td style="text-align:left;"><code>next</code></td><td style="text-align:left;"><a href="/api/webflo-routing/handler/next"><code>next</code></a></td><td style="text-align:left;">Control delegation function.</td></tr><tr><td style="text-align:left;"><code>fetch</code></td><td style="text-align:left;"><a href="/api/webflo-routing/handler/fetch"><code>fetch</code></a></td><td style="text-align:left;">Context-aware fetch API for inbound and outbound calls.</td></tr></tbody></table><h2 id="the-this-context" tabindex="-1">The <code>this</code> Context <a class="header-anchor" href="#the-this-context" aria-label="Permalink to &quot;The \`this\` Context&quot;">​</a></h2><p>Contextual properties are available on the <code>this</code> context:</p><table tabindex="0"><thead><tr><th style="text-align:left;">Property</th><th style="text-align:left;">Type</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>this.stepname</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">The current directory segment being handled.</td></tr><tr><td style="text-align:left;"><code>this.pathname</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">The current URL pathname up to the active step.</td></tr><tr><td style="text-align:left;"><code>this.filename</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">The filename of the executing handler (server-side only).</td></tr></tbody></table><div class="info custom-block"><p class="custom-block-title">See also</p><p><a href="/api/webflo-routing/handler/next#properties"><code>next</code></a></p></div><h2 id="return-types" tabindex="-1">Return Types <a class="header-anchor" href="#return-types" aria-label="Permalink to &quot;Return Types&quot;">​</a></h2><p>Handlers can return one of the following:</p><table tabindex="0"><thead><tr><th style="text-align:left;">Type</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;">Plain value</td><td style="text-align:left;">A JSON-serializable value or plain object used as the page&#39;s data binding.</td></tr><tr><td style="text-align:left;"><code>Response</code></td><td style="text-align:left;">A standard Web Fetch API <code>Response</code>.</td></tr><tr><td style="text-align:left;"><code>LiveResponse</code></td><td style="text-align:left;">A streaming/live response that can emit multiple payloads over time.</td></tr></tbody></table><h2 id="return-styles" tabindex="-1">Return Styles <a class="header-anchor" href="#return-styles" aria-label="Permalink to &quot;Return Styles&quot;">​</a></h2><p>You can deliver values in two ways:</p><table tabindex="0"><thead><tr><th style="text-align:left;">Style</th><th style="text-align:left;">When to use</th></tr></thead><tbody><tr><td style="text-align:left;"><code>return</code></td><td style="text-align:left;">Return a single value (<code>object</code>, <code>Response</code>, or <code>LiveResponse</code>).</td></tr><tr><td style="text-align:left;"><code>event.respondWith()</code></td><td style="text-align:left;">Emit one or more responses, including progressive/streamed updates. See <a href="/docs/concepts/realtime">/docs/concepts/realtime</a>.</td></tr></tbody></table><h3 id="event-respondwith-forms" tabindex="-1"><code>event.respondWith()</code> forms <a class="header-anchor" href="#event-respondwith-forms" aria-label="Permalink to &quot;\`event.respondWith()\` forms&quot;">​</a></h3><ul><li><code>event.respondWith(data)</code> — immediately deliver <code>data</code>.</li><li><code>event.respondWith(data, { done: false })</code> — deliver <code>data</code> and keep the channel open for more.</li><li><code>event.respondWith(data, (proxy) =&gt; { /* write to proxy */ })</code> — low-level streaming; complete when callback resolves or another <code>respondWith</code> is called.</li></ul><h2 id="generator-and-live-functions" tabindex="-1">Generator and Live Functions <a class="header-anchor" href="#generator-and-live-functions" aria-label="Permalink to &quot;Generator and Live Functions&quot;">​</a></h2><p>Handlers may be expressed as generators or &quot;live&quot; functions to naturally produce multiple values over time.</p><ul><li>Generator: <code>export function* GET(event) { yield {...}; return {...}; }</code></li><li>Live function: <code>export live function GET(event) { return {...} }</code><br> See <a href="/docs/concepts/realtime">/docs/concepts/realtime</a> for details.</li></ul><h2 id="lifecycle" tabindex="-1">Lifecycle <a class="header-anchor" href="#lifecycle" aria-label="Permalink to &quot;Lifecycle&quot;">​</a></h2><ul><li>Streams, generators, and live functions end when <code>HttpEvent.signal</code> aborts.</li><li>The root <code>HttpEvent</code> is aborted when all handlers in the subtree complete, the request is aborted, or realtime closes.</li></ul><h2 id="examples" tabindex="-1">Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;Examples&quot;">​</a></h2><p>Return plain data (rendered into templates via <code>document.bindings.data</code>):</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#C792EA;"> async</span><span style="color:#C792EA;"> function</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">  return</span><span style="color:#89DDFF;"> {</span><span style="color:#F07178;"> title</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">Hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> greeting</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &#39;</span><span style="color:#C3E88D;">Hello World!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;"> };</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>Return a <code>Response</code>:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#C792EA;"> async</span><span style="color:#C792EA;"> function</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">  return</span><span style="color:#BABED8;"> Response</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> ok</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> true</span><span style="color:#89DDFF;"> }</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>Progressively stream values:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#C792EA;"> async</span><span style="color:#C792EA;"> function</span><span style="color:#82AAFF;"> GET</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">  event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">respondWith</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> step</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 1</span><span style="color:#89DDFF;"> },</span><span style="color:#89DDFF;"> {</span><span style="color:#F07178;"> done</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;"> false</span><span style="color:#89DDFF;"> }</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">  await</span><span style="color:#89DDFF;"> new</span><span style="color:#FFCB6B;"> Promise</span><span style="color:#F07178;">(</span><span style="color:#BABED8;font-style:italic;">r</span><span style="color:#C792EA;"> =&gt;</span><span style="color:#82AAFF;"> setTimeout</span><span style="color:#F07178;">(</span><span style="color:#BABED8;">r</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;"> 200</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#BABED8;">  event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">respondWith</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> step</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;"> 2</span><span style="color:#89DDFF;"> }</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;font-style:italic;"> // done by default</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div>`,35)])])}const F=t(n,[["render",o]]);export{h as __pageData,F as default};
